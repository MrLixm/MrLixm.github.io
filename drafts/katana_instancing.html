<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#">
<head>
  <meta charset="UTF-8" />
  <title>Instancing in Katana | Liam Collod&#39;s Blog</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i,700%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Georama:wght@400;600&amp;" />
  <link rel="stylesheet" href="https://mrlixm.github.io/static/m-dark.css" />
  <link rel="icon" href="https://mrlixm.github.io/static/images/global/logo.png" type="image/x-ico" />
  <link rel="canonical" href="https://mrlixm.github.io/drafts/katana_instancing.html" />
  <link href="https://mrlixm.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Liam Collod Website" />
  <link href="https://mrlixm.github.io/feeds/software.atom.xml" type="application/atom+xml" rel="alternate" title="Liam Collod Website | software" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#20FC8F" />
  <meta name="twitter:site" content="@MrLixm" />
  <meta name="twitter:site:id" content="713068621203914752" />
  <meta property="og:site_name" content="Liam Collod&#39;s Blog" />
  <meta property="og:title" content="Instancing in Katana" />
  <meta name="twitter:title" content="Instancing in Katana" />
  <meta property="og:url" content="https://mrlixm.github.io/drafts/katana_instancing.html" />
  <meta property="og:description" content="Let‚Äôs see how to produce a flexible solution for instancing." />
  <meta name="twitter:description" content="Let‚Äôs see how to produce a flexible solution for instancing." />
  <meta property="og:image" content="https://mrlixm.github.io/static/images/global/cover_social.jpg" />
  <meta name="twitter:image" content="https://mrlixm.github.io/static/images/global/cover_social.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:type" content="article" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="https://mrlixm.github.io/" id="m-navbar-brand" class="m-col-t-9 m-col-m-none m-left-m"><img src="https://mrlixm.github.io/static/images/global/logo.png" alt="" />Liam Collod</a>
      <a id="m-navbar-show" href="#navigation" title="Show navigation" class="m-col-t-3 m-hide-m m-text-right"></a>
      <a id="m-navbar-hide" href="#" title="Hide navigation" class="m-col-t-3 m-hide-m m-text-right"></a>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-12 m-col-m-none">
            <li><a href="https://mrlixm.github.io/pages/work">Work</a></li>
            <li><a href="https://mrlixm.github.io/blog/" id="m-navbar-current">Blog</a></li>
            <li><a href="https://mrlixm.github.io/pages/contact">Contact</a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main>
<div class="m-container">
  <div class="m-row">
    <article class="m-col-m-10 m-nopadb">
      <header>
        <h1><a href="https://mrlixm.github.io/drafts/katana_instancing.html" rel="bookmark" title="Permalink to Instancing in Katana">
          <time class="m-date" datetime="2021-10-23T14:58:00+02:00">
            Oct <span class="m-date-day">23</span> 2021
          </time>
          Instancing in Katana
          <span class="m-label m-dim">draft</span>
        </a></h1>
        <p>Let‚Äôs see how to produce a flexible solution for instancing.</p>
      </header>
      <div class="m-clearfix-l"></div>
<!-- content -->
<p>Katana doesn‚Äôt offers ‚Äúready to go‚Äù solution for instancing (as for most things)
, if you add the fact that you render-engine might need a different
configuration, having a working solution can become hard depending of your industry knowledge.</p>
<p>I will explain my solution to have a flexible enough instancing system,
in hopes that this will save you some time.</p>
<p>You will also find a paragraph specific to <a href="#redshift">Redshift</a> where I had some troubles guessing what it needed.</p>
<aside class="contents m-block m-default" id="contents">
<h3>Contents</h3>
<ul>
<li><a href="#intro" id="id1">Intro</a></li>
<li><a href="#instancing-methods" id="id2">Instancing Methods</a><ul>
<li><a href="#leaf-level" id="id3">Leaf-level</a></li>
<li><a href="#hierarchical" id="id4">Hierarchical</a></li>
<li><a href="#array" id="id5">Array</a></li>
</ul>
</li>
<li><a href="#application" id="id6">Application</a></li>
<li><a href="#redshift" id="id7">Redshift</a></li>
</ul>
</aside>
<aside class="m-block m-warning">
<h3>Disclaimer</h3>
<p>My explanations reflects the experience I had with this subject and may not be
totally accurate. Be sure to contact me if you spot big mistakes.</p>
</aside>
<section id="intro">
<h2><a href="#id1">Intro</a></h2>
<p>As a first step, please read the Katana documentation on this subject:
<a href="https://support.foundry.com/hc/en-us/articles/360006999219">Q100518: Instancing Overview</a></p>
<p>An instance is not a magical object. It is just
a location with a defined list of attributes understanded by your render-engine.
You can as such create an instance with a simple <code>LocationCreate + AttributeSet</code>
(if you have time to loose) but we will be using OpScripts to do so.</p>
<p>Here is a quick diagram that could resume how an instance can be created :</p>
<img alt="instancing principle" class="m-image" src="https://mrlixm.github.io/static/images/blog/katana_instancing/diagram.png" />
<p>The basic principle is that an instance links at least to an <code>instance source</code> (a location).
The instance will create a ‚Äúcopy‚Äù of this instance source. You can then set
transformations overrides that will allow the instance having a different
position, rotation, etc, than the source.
Aditional attributes can also be set and used for shading to make the
instance even more different than the source.</p>
</section>
<section id="instancing-methods">
<h2><a href="#id2">Instancing Methods</a></h2>
<p>Instancing comes in different flavor, with ups and down for each one. And your
render-engine may even have some aditional/modified ones.</p>
<section id="leaf-level">
<h3><a href="#id3">Leaf-level</a></h3>
<p>(Never used this one)</p>
<p>The Katana documentation is pretty clear so I‚Äôm not going to re-explain anything.</p>
<div class="m-row">
<div class="m-col-s-6">
<aside class="m-block m-danger">
<h3>cons</h3>
<p>Major drawbacks is that you can‚Äôt have a location with children locations (to verify),
and well it seems every render-engine has a way to decide which location is the first one to instance üôÇ.</p>
</aside>
</div>
<div class="m-col-s-6">
<aside class="m-block m-success">
<h3>pros</h3>
<p>You just have to set a single attribute.</p>
<p>You can easily apply modification on a single instance (ex: a transform3D)</p>
</aside>
</div>
</div>
<p><em>Would love to know in what case this one can be more pertinent than the other methods.</em></p>
</section>
<section id="hierarchical">
<h3><a href="#id4">Hierarchical</a></h3>
<p>Each instance = one location.</p>
<div class="m-row">
<div class="m-col-s-6">
<aside class="m-block m-danger">
<h3>cons</h3>
<p>With too much instances (&gt;~100 000) you will start to see performance issues</p>
</aside>
</div>
<div class="m-col-s-6">
<aside class="m-block m-success">
<h3>pros</h3>
<p>You can easily apply modification on a single instance (ex: a transform3D)</p>
</aside>
</div>
</div>
</section>
<section id="array">
<h3><a href="#id5">Array</a></h3>
<p>One single location where each instance correspond to an index on each attribute.</p>
<div class="m-row">
<div class="m-col-s-6">
<aside class="m-block m-danger">
<h3>cons</h3>
<p>Complicated to get per-instance override.</p>
</aside>
</div>
<div class="m-col-s-6">
<aside class="m-block m-success">
<h3>pros</h3>
<p>Better performances.</p>
</aside>
</div>
</div>
<p class="m-transition">.</p>
<p>And there is probably some aditional pro/cons inheritent to your render-engine
so check the documentation and test stuff.</p>
<p>(For example , when I started to explore instancing, Redshift was not supporting
locations with children when using the <code>hierarchical</code> method.)</p>
</section>
</section>
<section id="application">
<h2><a href="#id6">Application</a></h2>
<p>The goal will be to create a node (a group) where, using the same parameters,
you could conveniently switch between different instancing methods.
I am going to forget about Leaf-level as I‚Äôm not familiar with it.</p>
</section>
<section id="redshift">
<h2><a href="#id7">Redshift</a></h2>
<p>The production where I had to look for instancing was using Redshift,
and unfortunately it seems that, at that time, the instancing features where
‚Äúminimally‚Äù implemented and some stuff was missing/broken.
Fortunately, Redshift developer‚Äôs Juanjo was very responsive and very quickly, fixed
all the issues I found as discussed <a href="https://redshift.maxon.net/topic/33461/more-documentation-for-instancing-in-katana?_=1634997159560">in this thread</a>.</p>
</section>
<!-- /content -->
      <footer>
        <p>Posted by <a href="https://mrlixm.github.io/author/liam-collod.html">Liam Collod</a> on <time datetime="2021-10-23T14:58:00+02:00">Sat 23 October 2021</time> in <a href="https://mrlixm.github.io/category/software.html">software</a>. <span class="m-label m-dim">draft</span> Tags: <a href="https://mrlixm.github.io/tag/katana.html">katana</a>, <a href="https://mrlixm.github.io/tag/instancing.html">instancing</a>, <a href="https://mrlixm.github.io/tag/lua.html">lua</a>.</p>
      </footer>
    </article>
    <nav class="m-navpanel m-col-m-2">
      <h3>Categories</h3>
      <ol class="m-block-bar-m">
        <li><a href="https://mrlixm.github.io/category/breakdown.html">breakdown</a></li>
        <li><a href="https://mrlixm.github.io/category/coding.html">coding</a></li>
        <li><a href="https://mrlixm.github.io/category/meta.html">meta</a></li>
      </ol>
      <h3>Tag cloud</h3>
      <ul class="m-tagcloud">
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/discord.html">discord</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/katana.html">katana</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/lua.html">lua</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/mari.html">mari</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/maya.html">maya</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/memes.html">memes</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/osl.html">osl</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/production.html">production</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/python.html">python</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/qt.html">qt</a></li>
        <li class="m-tag-5"><a href="https://mrlixm.github.io/tag/resources.html">resources</a></li>
      </ul>
    </nav>
  </div>
</div>
</main>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Copyright ¬© <a href="mailto:lcollod&#64;gmail.com">Liam Collod</a> - 2021. All rights
        reserved. Made with <a href="https://blog.getpelican.com/">Pelican</a> and
        <a href="https://mcss.mosra.cz/">m.css</a> .</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>